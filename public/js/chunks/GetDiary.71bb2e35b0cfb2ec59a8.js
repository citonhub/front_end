(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{798:function(t,e,i){"use strict";i.r(e);var a=i(244),o=i.n(a),s=(i(242),{data:function(){return{NameRule:[function(t){return!!t||"Oh! you missed this."},function(t){return t.length<=60||"Diary name must be less than 60 characters"}],requiredRule:[function(t){return!!t||"Oh! you missed this."}],diaryName:"",channel:"",selectedChannel:"",description:"",imageUrl:"",channelList:[],input:"",language:"",image:"",imageDefault:0,formState:!1,loading:!1,accessType:"private"}},mounted:function(){this.$root.showTopBar=!1,this.fetchChannels()},methods:{selectDefaultImg:function(t,e){this.imageDefault="default_"+e,this.$root.croppedImage=t,this.$root.imageExist=!1},showAlert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;"info"==i&&o.a.info({title:t,message:e,zindex:"9999999999",position:"bottomRight",timeout:5e3,transitionInMobile:"fadeIn",transitionOutMobile:"fadeOut"}),"success"==i&&o.a.success({title:t,message:e,zindex:"9999999999",timeout:5e3,position:"bottomRight",transitionInMobile:"fadeIn",transitionOutMobile:"fadeOut"}),"warning"==i&&o.a.warning({title:t,message:e,zindex:"9999999999",timeout:5e3,position:"bottomRight",transitionInMobile:"fadeIn",transitionOutMobile:"fadeOut"}),"error"==i&&o.a.error({title:t,message:e,zindex:"9999999999",timeout:5e3,position:"bottomRight",transitionInMobile:"fadeIn",transitionOutMobile:"fadeOut"})},handleBlob:function(t){var e=t.split(";"),i=e[0].split(":")[1],a=i.slice(6),o=e[1].split(",")[1];return[this.b64toBlob(o,i),a]},goBack:function(){window.history.length>1?this.$router.go(-1):this.$router.push("/")},crophandler:function(t){var e=this;this.imageDefault=0;var i=t.target;if(i.files&&i.files[0]){var a=new FileReader;a.onload=function(t){e.$root.imagepath=t.target.result,e.imagepath=t.target.result,e.$root.imageExist=!0},a.readAsDataURL(i.files[0]),this.$router.push({path:"/crop-image"})}},b64toBlob:function(t,e,i){e=e||"",i=i||512;for(var a=atob(t),o=[],s=0;s<a.length;s+=i){for(var r=a.slice(s,s+i),n=new Array(r.length),c=0;c<r.length;c++)n[c]=r.charCodeAt(c);var l=new Uint8Array(n);o.push(l)}return new Blob(o,{type:e})},fetchChannels:function(){var t=this;axios.get("/fetch-user-channels-diary").then((function(e){200==e.status&&(t.channelList=e.data)})).catch((function(t){}))},goback:function(){this.$router.push({path:"/board/diary/list"})},createDiary:function(){var t=this;if(this.$refs.diaryForm.validate()){this.loading=!0;var e=new FormData;if(this.$root.imageExist){var i=this.handleBlob(this.$root.croppedImage);e.append("image",i[0]),e.append("image_ext",i[1])}else e.append("image_default",this.imageDefault);e.append("name",this.diaryName),e.append("channel_id",this.selectedChannel),e.append("description",this.description),e.append("access_type",this.accessType),axios.post("/create-diary",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){200==e.status&&(t.loading=!1,t.$root.getLocalStore("user_diary_"+t.$root.username).then((function(i){if(null!=i){var a=JSON.parse(i);t.$root.diaryList=a,t.$root.diaryList.unshift(e.data.dairy),t.$root.LocalStore("user_diary_"+t.$root.username,t.$root.diaryList),t.$router.push({path:"/board/diary/list"})}else t.$router.push({path:"/board/diary/list"})})))})).catch((function(e){t.showAlert("Oops!"," Unable to create diary","error"),t.loading=!1}))}}}}),r=i(4),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"px-0",staticStyle:{background:"transparent","font-family":"BodyFont"}},[i("div",{staticClass:"col-lg-10 offset-lg-1 py-1 col-md-10 offset-md-1 px-2 d-md-block d-none fixed-top",staticStyle:{position:"sticky","z-index":"9999999999",background:"#F5F5FB","border-bottom":"1px solid #c5c5c5"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-6 py-0 my-0"},[i("h5",[i("v-btn",{attrs:{icon:""},on:{click:t.goback}},[i("v-icon",[t._v("las la-arrow-left")])],1),t._v(" Create a diary")],1)]),t._v(" "),i("div",{staticClass:"col-6 py-0 my-0 text-right"},[i("v-btn",{staticStyle:{"font-size":"12px","font-weight":"bolder",color:"white","font-family":"MediumFont"},attrs:{loading:t.loading,small:"",rounded:"",color:"#3C87CD"},on:{click:t.createDiary}},[t._v("\n             Done\n           ")])],1)])]),t._v(" "),i("div",{staticClass:" px-0 col-12 pb-0 pt-2 d-md-none d-block fixed-top",staticStyle:{position:"sticky",background:"#F5F5FB","border-bottom":"1px solid #c5c5c5"}},[i("div",{staticClass:"row py-0"},[i("div",{staticClass:"col-8 py-0 my-0"},[i("h6",{staticStyle:{"font-size":"17px"}},[i("v-btn",{attrs:{icon:""},on:{click:t.goback}},[i("v-icon",[t._v("las la-arrow-left")])],1),t._v("Create a diary")],1)]),t._v(" "),i("div",{staticClass:"col-4 py-0 my-0 text-right"},[i("v-btn",{staticStyle:{"font-size":"12px","font-weight":"bolder","text-transform":"none",color:"white","font-family":"MediumFont"},attrs:{loading:t.loading,small:"",rounded:"",color:"#3C87CD"},on:{click:t.createDiary}},[t._v("\n             Done\n           ")])],1)])]),t._v(" "),i("v-app",{staticClass:"col-12 px-0",staticStyle:{background:"transparent","font-family":"BodyFont"}},[i("v-form",{ref:"diaryForm",staticClass:"col-lg-8 offset-lg-2 py-1 col-md-10 offset-md-1 px-2",model:{value:t.formState,callback:function(e){t.formState=e},expression:"formState"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-lg-8  py-1 my-0 px-2"},[i("div",{staticClass:"mb-1",staticStyle:{"font-size":"14px"}},[t._v("1. Name your diary")]),t._v(" "),i("v-text-field",{staticStyle:{"font-size":"13px"},attrs:{label:"Diary name",counter:"60",rules:t.NameRule,"persistent-hint":"","prepend-inner-icon":"las la-book",color:"#3C87CD"},model:{value:t.diaryName,callback:function(e){t.diaryName=e},expression:"diaryName"}})],1),t._v(" "),i("div",{staticClass:"col-12 py-1 my-0 mt-n3 px-2 pl-3"},[i("div",{staticClass:"my-2",staticStyle:{"font-size":"14px"}},[t._v("2. Upload your diary photo")]),t._v(" "),i("v-sheet",{staticClass:"py-0  px-0 mt-2 sheetbackImg",style:"background-image:url("+this.$root.croppedImage+");border-radius:10px;cursor:pointer;background-size:cover;",attrs:{elevation:"0",height:"100",width:"120"}},[i("v-sheet",{staticClass:"py-auto px-auto d-flex",staticStyle:{"border-radius":"10px"},attrs:{color:"rgba(15, 33, 36, 0.3)",elevation:"0",height:"100%",width:"100%"}},[i("input",{ref:"settingsimage",staticStyle:{opacity:"0",width:"120px",height:"100px",overflow:"hidden",position:"absolute","z-index":"10"},attrs:{type:"file",id:"settingsimage",accept:"image/x-png,image/jpeg,image/jpg"},on:{change:t.crophandler}}),t._v(" "),i("v-icon",{staticClass:"mx-auto white-text"},[t._v("mdi-camera-plus")])],1)],1),t._v(" "),i("div",{staticClass:"mt-3",staticStyle:{"font-size":"13px",color:"grey"}},[t._v("Or select from defaults")]),t._v(" "),i("div",{staticClass:"d-flex flex-row mt-3"},[i("div",{staticClass:"mr-2",staticStyle:{"border-radius":"10px",height:"60px",width:"60px",cursor:"pointer","background-color":"#c5c5c5","background-image":"url(/imgs/background3.jpg)","background-size":"cover","background-repeat":"no-repeat",border:"1px solid #c5c5c5"},on:{click:function(e){return t.selectDefaultImg("/imgs/background3.jpg",1)}}}),t._v(" "),i("div",{staticClass:"mr-2",staticStyle:{"border-radius":"10px",height:"60px",width:"60px",cursor:"pointer","background-color":"#c5c5c5","background-image":"url(/imgs/background1.jpg)","background-size":"cover","background-repeat":"no-repeat",border:"1px solid #c5c5c5"},on:{click:function(e){return t.selectDefaultImg("/imgs/background1.jpg",2)}}}),t._v(" "),i("div",{staticClass:"mr-2",staticStyle:{"border-radius":"10px",height:"60px",width:"60px",cursor:"pointer","background-color":"#c5c5c5","background-image":"url(/imgs/imgproj2.jpeg)","background-size":"cover","background-repeat":"no-repeat",border:"1px solid #c5c5c5"},on:{click:function(e){return t.selectDefaultImg("/imgs/imgproj2.jpeg",3)}}})])],1),t._v(" "),i("div",{staticClass:"col-lg-8  py-1 mt-3 px-2 mb-1"},[i("div",{staticClass:"mb-2",staticStyle:{"font-size":"14px"}},[t._v("3. Control diary access.")]),t._v(" "),i("v-chip",{staticClass:"d-inline-block ml-2 my-1",style:"private"!=t.accessType?"font-size:13px;cursor:pointer;":"font-size:13px;cursor:pointer;color:white;",attrs:{outlined:"private"!=t.accessType,color:"#3C87CD"},on:{click:function(e){t.accessType="private"}}},[t._v("Private")]),t._v(" "),i("v-chip",{staticClass:"d-inline-block ml-1 my-1",style:"public"!=t.accessType?"font-size:13px;cursor:pointer;":"font-size:13px;cursor:pointer;color:white;",attrs:{outlined:"public"!=t.accessType,color:"#3C87CD"},on:{click:function(e){t.accessType="public"}}},[t._v("Public")])],1),t._v(" "),i("div",{staticClass:" col-lg-12 py-1 my-0 px-2"},[i("div",{staticStyle:{"font-size":"14px"}},[t._v("4. Select a channel "),i("span",{staticStyle:{"font-size":"12px",color:"grey"}},[t._v("(optional)")])]),t._v(" "),i("div",{staticClass:"col-lg-8 py-0 px-0"},[i("v-select",{staticStyle:{"font-size":"13px"},attrs:{dense:"",counter:"20",placeholder:"select...","persistent-hint":"",chips:"",items:t.channelList,"item-value":"space_id","item-text":"name",color:"#3C87CD"},scopedSlots:t._u([{key:"selection",fn:function(e){return[i("v-chip",t._b({key:JSON.stringify(e.item),staticClass:"my-1",staticStyle:{"font-size":"12px","font-family":"BodyFont"},attrs:{"input-value":e.selected,color:"#3C87CD",dense:"",outlined:"",disabled:e.disabled}},"v-chip",e.attrs,!1),[t._v("\n             \n              "+t._s(e.item.name)+"\n            ")])]}}]),model:{value:t.selectedChannel,callback:function(e){t.selectedChannel=e},expression:"selectedChannel"}})],1)]),t._v(" "),i("div",{staticClass:"col-lg-8  py-1 my-0 px-2"},[i("div",{staticClass:"mb-3",staticStyle:{"font-size":"14px"}},[t._v("5. About your new diary")]),t._v(" "),i("v-textarea",{staticStyle:{"font-size":"13px"},attrs:{placeholder:"What is this diary for?",counter:"300",rules:t.requiredRule,outlined:"",color:"#3C87CD"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),t._v(" "),i("div",{staticClass:"col-12"})])])],1)],1)}),[],!1,null,"6c642e60",null);e.default=n.exports}}]);