(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{357:function(t,e,s){var o=s(645);"string"==typeof o&&(o=[[t.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};s(25)(o,i);o.locals&&(t.exports=o.locals)},644:function(t,e,s){"use strict";var o=s(357);s.n(o).a},645:function(t,e,s){(t.exports=s(24)(!1)).push([t.i,"\ntextarea[data-v-38261bf0] {\n    font-size:13px; \n    background:whitesmoke;\n    width:100%; \n    height: 55px;\n    padding: 4px 6px;\n    resize:none; \n    overflow-x: hidden;\n     overflow-y: auto;\n    border:1px solid #e6e6e6; \n    border-radius:2px;\n}\n",""])},804:function(t,e,s){"use strict";s.r(e);var o={data:function(){return{wordCount:0,showSend:!1,audioChunks:[],Alert:!0,typingText:"",content:this.$root.postContent,alertMsg:"",recording:!1,audioBlob:"",mediaRecorder:null,contentInWord:"",NewMsg:"",input:"",timer:"0:00",shiftIsPressed:!1,showAttachment:!0,seconds:0,minute:0,recorderInterval:null}},components:{},mounted:function(){this.$root.bottomEditorValue=this.$refs.textBottom,this.$root.channelBottomComp=this},computed:{compiledMarkdown:function(){var t=new marked.Renderer;return t.link=function(t,e,s){return marked.Renderer.prototype.link.call(this,t,e,s).replace("<a","<a target='_blank' ")},marked.setOptions({renderer:t}),marked(this.input,{sanitize:!0})}},methods:{showShareBoard:function(){this.$router.push({path:"/channels/"+this.$root.selectedSpace.space_id+"/share"})},reFocusEditor:function(){this.$refs.textBottom.focus()},toggleEmoji:function(){this.$root.showEmojiBox?this.$root.showEmojiBox=!1:this.$root.showEmojiBox=!0},handelkeyAct:function(t){16==t.keyCode&&(this.shiftIsPressed=!0),16!=t.keyCode&&13!=t.keyCode&&(this.shiftIsPressed=!1),13==t.keyCode&&this.shiftIsPressed&&(t.preventDefault(),this.sendMessage(),this.shiftIsPressed=!1)},shareHandler:function(){this.$root.sharePage=!0,this.$root.showChatBottom=!1},update:function(t){this.input=t.target.value,this.wordCount=this.input.length,this.wordCount>0?(this.showSend=!0,this.isTyping()):this.showSend=!1,this.contentInWord=this.compiledMarkdown},reFocus:function(){this.editor.focus()},toggleRecording:function(){this.recording?(this.stoprecord(),this.recording=!1):(this.recording=!0,this.startrecord())},startrecord:function(){var t=this;this.recording=!0,this.$root.recordUrl="",this.audioChunks=[],navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.mediaRecorder=new MediaRecorder(e),t.mediaRecorder.start(),t.startCounter(),t.audioChunks=[],t.mediaRecorder.addEventListener("dataavailable",(function(e){t.audioChunks.push(e.data)})),t.mediaRecorder.addEventListener("stop",(function(){t.audioBlob=new Blob(t.audioChunks),t.$root.recorderBlob=new Blob(t.audioChunks),t.$root.recordUrl=URL.createObjectURL(t.audioBlob)}))}))},startCounter:function(){var t=this;this.recorderInterval=null,this.recorderInterval=setInterval((function(){t.seconds++;var e="";t.seconds<10?e="0"+t.seconds:60==t.seconds?(t.seconds=0,t.minute++,e="00"):e=t.seconds,t.timer=t.minute+":"+e}),1e3)},stoprecord:function(t){var e=this;this.mediaRecorder.stop(),clearInterval(this.recorderInterval),this.recording=!1,this.seconds=0,this.minute=0,this.timer="0:00",setTimeout((function(){"send"==t&&e.sendRecord()}),1e3)},makeUUID:function(){return"id"+Math.random().toString(16).slice(2)},makeMessage:function(t,e,s,o){var i={content:null,created_at:moment().subtract(1,"hours"),is_reply:s,message_id:this.makeUUID(),id:this.makeUUID(),initialSize:200,index_count:this.$root.returnLastIndex()+1,replied_message:o,replied_message_id:null,showReply:!1,showDate:null,loading:!0,progressValue:0,space_id:this.$route.params.spaceId,tagged:!1,type:t,user_id:this.$root.user_temp_id,username:this.$root.username,video:{},audio:{},code:{},image:{},file:{}};return"image"==t&&(i.image=e),"video"==t&&(i.video=e),"audio"==t&&(i.audio=e),"code"==t&&(i.code=e),"file"==t&&(i.file=e),i},isTyping:function(){var t=this,e=window.Echo.join("global");setTimeout((function(){e.whisper("typing",{user:t.$root.username,typing:!0,spaceId:t.$route.params.spaceId})}),1e3),setTimeout((function(){e.whisper("typing",{user:t.$root.username,typing:!1,spaceId:t.$route.params.spaceId})}),5e3)},sendRecord:function(){var t=new FormData;this.$root.NewMsg=this.makeMessage("audio",null,null,[]),this.attachment_type="voiceRecord",t.append("audio",this.$root.recorderBlob),t.append("display_name","Voice Record"),this.$root.Messages.push(this.$root.NewMsg),this.$root.spaceFullData.messages=this.$root.Messages,this.$root.LocalStore("full_"+this.$route.params.spaceId+this.$root.username,this.$root.spaceFullData),this.$root.scrollToBottom(),t.append("current_user",JSON.stringify(this.generateOnlineUsersList())),t.append("is_reply",this.$root.is_reply),t.append("attachment_type",this.attachment_type),t.append("space_id",this.$route.params.spaceId),t.append("temp_id",this.$root.NewMsg.message_id),t.append("device_id",this.$root.userDeviceId),this.$root.updateSpaceTracker(this.$root.selectedSpace.space_id,this.$root.NewMsg),this.$root.sendShareMessage(t)},generateOnlineUsersList:function(){var t=this,e=[];return this.$root.selectedSpaceMembers.forEach((function(s){var o=t.$root.globalUsers.filter((function(t){return t.id==s.user_id}));0!=o.length&&e.push(o[0])})),e},sendMessage:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!=this.input.length){this.input="",this.showSend=!1,this.$root.showRootReply=!1,t&&this.$refs.textBottom.focus();var e=[];this.$root.is_reply?this.$root.NewMsg=this.makeMessage(null,e,"1",this.$root.replyMessage):this.$root.NewMsg=this.makeMessage(null,e,null,[]),this.$root.NewMsg.content=this.contentInWord,this.$root.Messages.push(this.$root.NewMsg),this.$root.spaceFullData.messages=this.$root.Messages,this.$root.LocalStore("full_"+this.$route.params.spaceId+this.$root.username,this.$root.spaceFullData),this.$root.scrollToBottom();var s={content:this.contentInWord,space_id:this.$route.params.spaceId,is_reply:this.$root.is_reply,current_user:JSON.stringify(this.generateOnlineUsersList()),replied_message_id:this.$root.replyMessage.message_id,attachment_type:null,temp_id:this.$root.NewMsg.message_id,device_id:this.$root.userDeviceId};this.$root.is_reply=!1,this.$root.updateSpaceTracker(this.$root.selectedSpace.space_id,this.$root.NewMsg),this.$root.sendTextMessage(s)}},focusEditor:function(){this.showAttachment=!1,this.$root.showEmojiBox=!1},blurEditor:function(){this.showAttachment=!0}}},i=(s(644),s(4)),r=Object(i.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row px-md-3 py-0"},[s("div",{staticClass:"col-12 py-1 my-0 d-flex px-md-2 px-2 flex-row",staticStyle:{"align-items":"center","justify-content":"center"}},[t.recording?[s("div",{staticClass:"ml-auto d-flex flex-row",staticStyle:{"align-items":"center","justify-content":"center"}},[s("v-btn",{staticClass:"bg-danger",attrs:{icon:""},on:{click:function(e){return t.stoprecord("cancle")}}},[s("v-icon",{attrs:{color:"#ffffff"}},[t._v("mdi-close")])],1),t._v(" "),s("div",{staticClass:"mx-3 ",staticStyle:{"font-size":"14px",color:"gray","font-family":"BodyFont"}},[t._v(t._s(t.timer))]),t._v(" "),s("v-btn",{staticClass:"bg-success",attrs:{icon:""},on:{click:function(e){return t.stoprecord("send")}}},[s("v-icon",{attrs:{color:"#ffffff"}},[t._v("mdi-check")])],1),t._v(" "),s("v-btn",{staticClass:"mx-1",attrs:{icon:""}},[s("v-icon",[t._v("las la-microphone")])],1)],1)]:[t.showAttachment&&"Bot"!=this.$root.selectedSpace.type?s("v-btn",{staticClass:"mx-md-1",attrs:{icon:""},on:{click:t.showShareBoard}},[s("v-icon",[t._v("las la-paperclip")])],1):t._e(),t._v(" "),s("v-btn",{staticClass:"mx-md-1 mr-1",attrs:{icon:""},on:{click:t.toggleEmoji}},[s("v-icon",[t._v("las la-grin")])],1),t._v(" "),s("textarea",{ref:"textBottom",staticStyle:{"font-size":"13px"},attrs:{placeholder:t.$t("general.type_here")},domProps:{value:t.input},on:{input:t.update,keydown:t.handelkeyAct,focus:t.focusEditor,blur:t.blurEditor}}),t._v(" "),"Bot"!=this.$root.selectedSpace.type?[t.showSend?s("v-btn",{staticClass:"mx-md-1",attrs:{icon:""},on:{click:t.sendMessage}},[s("v-icon",[t._v("las la-send")])],1):s("v-btn",{staticClass:"mx-md-1",attrs:{icon:""},on:{click:t.startrecord}},[s("v-icon",[t._v("las la-microphone")])],1)]:[s("v-btn",{staticClass:"mx-md-1",attrs:{icon:""},on:{click:t.sendMessage}},[s("v-icon",[t._v("las la-send")])],1)]]],2)])}),[],!1,null,"38261bf0",null);e.default=r.exports}}]);